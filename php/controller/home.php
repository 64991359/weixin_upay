<?php namespace controller;  class home { public function index($param) { } public function start($param) { $money = $param['money'];  $input = array( 'money' => $money, 'order_number' => time() - 1540000000 . rand(111,999), 'time' => time(), 'appid' => '233rfds234rf32r3fdsf', 'sign' => '' );  ksort($input);  $buff = null;  foreach ($input as $k => $v) { if ($k != "sign" && $v != "" && !is_array($v)) { $buff .= $k . "=" . $v . "&";  } } $m = new \lib\model();  $userinfo = $m->find("select * from `user` where appid='{$input['appid']}'");  $appkey = @$userinfo['appkey'];  if (empty($appkey)) { errmsg("用户没有设置appkey");  } $string = $buff . "&key={$appkey}";  $input['sign'] = $sign = md5($string);  $url = "/pay?".$string ."&sign=".$sign;  header("Location: $url");  die;  } public function paycode_qr($param) { $paycodestring = base64_decode($param['val']);  include ROOTPATH.'lib/phpqrcode.php';  \QRcode::png($paycodestring, false, QR_ECLEVEL_L, 8, 1);  } } 